<launch>
  <arg name="is_redundant" default="true"/>

  <!-- AD API options -->
  <arg name="launch_deprecated_api" default="false"/>
  <arg name="launch_default_ad_api" default="true"/>
  <arg name="launch_rviz_adaptors" default="true"/>
  <arg name="launch_ad_api_distributor" default="true" if="$(var is_redundant)"/>
  <arg name="launch_ad_api_distributor" default="false" unless="$(var is_redundant)"/>

  <arg name="is_main" if="$(eval &quot;'$(var ecu_name)'=='main'&quot;)" default="true"/>
  <arg name="is_main" unless="$(eval &quot;'$(var ecu_name)'=='main'&quot;)" default="false"/>

  <!-- rosbridge options -->
  <arg name="rosbridge_enabled" default="false"/>
  <arg name="rosbridge_respawn" default="true"/>
  <arg name="rosbridge_max_message_size" default="10000000"/>

  <!-- Deprecated API -->
  <group if="$(var launch_deprecated_api)">
    <include file="$(find-pkg-share tier4_autoware_api_launch)/launch/deprecated_api.launch.xml"/>
  </group>

  <!-- AD API -->
  <group if="$(var launch_default_ad_api)">
    <include file="$(find-pkg-share ad_api_distributor)/launch/remapped_api.launch.py" if="$(var is_redundant)">
      <arg name="prefix" value="$(var ecu_name)"/>
    </include>
    <include file="$(find-pkg-share default_ad_api)/launch/default_ad_api.launch.py" unless="$(var is_redundant)"/>
  </group>
  <group>
    <include file="$(find-pkg-share ad_api_adaptors)/launch/rviz_adaptors.launch.xml" if="$(var launch_rviz_adaptors)"/>
    <include file="$(find-pkg-share ad_api_distributor)/launch/distributor.launch.xml" if="$(var launch_ad_api_distributor)"/>
  </group>

  <!-- RTC controller -->
  <group>
    <push-ros-namespace namespace="autoware_api/external/rtc_controller"/>
    <node_container pkg="rclcpp_components" exec="component_container_mt" name="container" namespace="" ros_args="--log-level autoware_api.external.rtc_controller.container:=warn">
      <composable_node pkg="autoware_iv_external_api_adaptor" plugin="external_api::RTCController" name="node"/>
    </node_container>
  </group>

  <!-- rosbridge -->
  <group if="$(var rosbridge_enabled)">
    <include file="$(find-pkg-share rosbridge_server)/launch/rosbridge_websocket_launch.xml">
      <arg name="respawn" value="$(var rosbridge_respawn)"/>
      <arg name="max_message_size" value="$(var rosbridge_max_message_size)"/>
    </include>
  </group>
</launch>
